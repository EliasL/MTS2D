#include <math.h>
#include "matrix2x2.h"
struct thing
{
    double zeroing_energy;
};

   void calculate_energy(){
        double burgers   = 1.;
        double beta = -0.25;
        double K=4.;
        thing s;
        // Uses the reduced metrics
        double c11 = 3;
        double c22 = 2;
        double c12 = 1;
        Matrix2x2<double> r_s; 
        double energy = 1;
        

        double v1 = c11*c22;
        double v2 = c12*c12;
        double v3 = v1-v2; 
        double v4 = c11-c22;
        double v5 = 1.0/4.0; 
        double v6 = c11-c12*4.0+c22; 
        double v7 = pow(v6,2.0); 
        double v8 = pow(v6,3.0);
        double v9 = pow(v4,2.0);
        double v10 = (v9*v5)/v3+(v7*(1.0/1.2E1))/v3;
        double v11 = pow(v10,2.0); 
        double v12 = pow(v10,3.0); 
        double v13 = ((c11*(1.0/6.0)-c12*(2.0/3.0)+c22*(1.0/6.0))/v3+(c11*(1.0/2.0)-c22*(1.0/2.0))/v3-c22*1.0/pow(v3,2.0)*v7*(1.0/1.2E1)-c22*v9*1.0/pow(v3,2.0)*v5);
        double v14 = (c11*(-2.0/3.0)+c12*(8.0/3.0)-c22*(2.0/3.0))/v3+c12*1.0;
        double v15 = sqrt(v3);
         


        energy  = -K*(log(v3/burgers)-v3/burgers)+beta*(pow(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6),2.0)*9.46969696969697E-4-v12*(4.1E1/9.9E1)+(v10)*1.0/pow(v3,2.0)*pow(c11-c12+c22,4.0)*(1.0/8.1E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(c11-c12+c22)*(7.0/1.98E2))+pow(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6),2.0)*(1.7E1/5.28E2)+v12*(4.0/1.1E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,3.0)*(1.0/2.7E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(c11-c12+c22)*(8.0/3.3E1);
        energy -= s.zeroing_energy;
        r_s[0][0] = -beta*(v11*v13*(4.1E1/3.3E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v9*1.0/pow(v3,3.0/2.0)-1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)+c22*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)-c22*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(1.0/5.28E2)-(v10)*1.0/pow(v3,2.0)*pow(c11-c12+c22,3.0)*(4.0/8.1E1)-1.0/pow(v3,2.0)*pow(c11-c12+c22,4.0)*v13*(1.0/8.1E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(7.0/1.98E2)+c22*(v10)*1.0/pow(v3,3.0)*pow(c11-c12+c22,4.0)*(2.0/8.1E1)-(v10)*1.0/v15*(c11-c12+c22)*(v9*1.0/pow(v3,3.0/2.0)-1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)+c22*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)-c22*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(7.0/1.98E2)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/v15*(c11-c12+c22)*v13*(7.0/1.98E2)-c22*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/pow(v3,3.0/2.0)*(c11-c12+c22)*(7.0/3.96E2))+K*(c22/burgers-c22/v3)+v11*v13*(1.2E1/1.1E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v9*1.0/pow(v3,3.0/2.0)-1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)+c22*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)-c22*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(1.7E1/2.64E2)+1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,3.0)*(v9*1.0/pow(v3,3.0/2.0)-1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)+c22*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)-c22*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(1.0/2.7E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,2.0)*(1.0/9.0)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(8.0/3.3E1)+c22*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,5.0/2.0)*pow(c11-c12+c22,3.0)*(1.0/1.8E1)-(v10)*1.0/v15*(c11-c12+c22)*(v9*1.0/pow(v3,3.0/2.0)-1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)+c22*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)-c22*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(8.0/3.3E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/v15*(c11-c12+c22)*v13*(8.0/3.3E1)-c22*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/pow(v3,3.0/2.0)*(c11-c12+c22)*(4.0/3.3E1);

        r_s[1][1] = beta*(v11*((c11*(-1.0/6.0)+c12*(2.0/3.0)-c22*(1.0/6.0))/v3+(c11*(1.0/2.0)-c22*(1.0/2.0))/v3+c11*1.0/pow(v3,2.0)*v7*(1.0/1.2E1)+c11*v9*1.0/pow(v3,2.0)*v5)*(4.1E1/3.3E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(-v9*1.0/pow(v3,3.0/2.0)+1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)-c11*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)+c11*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(1.0/5.28E2)+(v10)*1.0/pow(v3,2.0)*pow(c11-c12+c22,3.0)*(4.0/8.1E1)-1.0/pow(v3,2.0)*pow(c11-c12+c22,4.0)*((c11*(-1.0/6.0)+c12*(2.0/3.0)-c22*(1.0/6.0))/v3+(c11*(1.0/2.0)-c22*(1.0/2.0))/v3+c11*1.0/pow(v3,2.0)*v7*(1.0/1.2E1)+c11*v9*1.0/pow(v3,2.0)*v5)*(1.0/8.1E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(7.0/1.98E2)-c11*(v10)*1.0/pow(v3,3.0)*pow(c11-c12+c22,4.0)*(2.0/8.1E1)-(v10)*1.0/v15*(c11-c12+c22)*(-v9*1.0/pow(v3,3.0/2.0)+1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)-c11*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)+c11*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(7.0/1.98E2)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/v15*(c11-c12+c22)*((c11*(-1.0/6.0)+c12*(2.0/3.0)-c22*(1.0/6.0))/v3+(c11*(1.0/2.0)-c22*(1.0/2.0))/v3+c11*1.0/pow(v3,2.0)*v7*(1.0/1.2E1)+c11*v9*1.0/pow(v3,2.0)*v5)*(7.0/1.98E2)+c11*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/pow(v3,3.0/2.0)*(c11-c12+c22)*(7.0/3.96E2))+K*(c11/burgers-c11/v3)-v11*((c11*(-1.0/6.0)+c12*(2.0/3.0)-c22*(1.0/6.0))/v3+(c11*(1.0/2.0)-c22*(1.0/2.0))/v3+c11*1.0/pow(v3,2.0)*v7*(1.0/1.2E1)+c11*v9*1.0/pow(v3,2.0)*v5)*(1.2E1/1.1E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(-v9*1.0/pow(v3,3.0/2.0)+1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)-c11*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)+c11*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(1.7E1/2.64E2)-1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,3.0)*(-v9*1.0/pow(v3,3.0/2.0)+1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)-c11*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)+c11*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(1.0/2.7E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,2.0)*(1.0/9.0)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(8.0/3.3E1)+c11*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,5.0/2.0)*pow(c11-c12+c22,3.0)*(1.0/1.8E1)+(v10)*1.0/v15*(c11-c12+c22)*(-v9*1.0/pow(v3,3.0/2.0)+1.0/pow(v3,3.0/2.0)*v7*(1.0/3.0)-c11*1.0/pow(v3,5.0/2.0)*v8*(1.0/6.0)+1.0/pow(v3,3.0/2.0)*(c11*2.0-c22*2.0)*(v6)+c11*v9*1.0/pow(v3,5.0/2.0)*(v6)*(3.0/2.0))*(8.0/3.3E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/v15*(c11-c12+c22)*((c11*(-1.0/6.0)+c12*(2.0/3.0)-c22*(1.0/6.0))/v3+(c11*(1.0/2.0)-c22*(1.0/2.0))/v3+c11*1.0/pow(v3,2.0)*v7*(1.0/1.2E1)+c11*v9*1.0/pow(v3,2.0)*v5)*(8.0/3.3E1)-c11*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/pow(v3,3.0/2.0)*(c11-c12+c22)*(4.0/3.3E1);

        r_s[0][1] = v11*(v14/pow(v3,2.0)*v7*(1.0/6.0)+c12*v9*1.0/pow(v3,2.0)*(1.0/2.0))*(1.2E1/1.1E1)-K*((c12*2.0)/burgers-(c12*2.0)/v3)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v9*1.0/pow(v3,3.0/2.0)*4.0-1.0/pow(v3,3.0/2.0)*v7*(4.0/3.0)+c12*1.0/pow(v3,5.0/2.0)*v8*(1.0/3.0)-c12*v9*1.0/pow(v3,5.0/2.0)*(v6)*3.0)*(1.7E1/2.64E2)-beta*(v11*(v14/pow(v3,2.0)*v7*(1.0/6.0)+c12*v9*1.0/pow(v3,2.0)*(1.0/2.0))*(4.1E1/3.3E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v9*1.0/pow(v3,3.0/2.0)*4.0-1.0/pow(v3,3.0/2.0)*v7*(4.0/3.0)+c12*1.0/pow(v3,5.0/2.0)*v8*(1.0/3.0)-c12*v9*1.0/pow(v3,5.0/2.0)*(v6)*3.0)*(1.0/5.28E2)+(v10)*1.0/pow(v3,2.0)*pow(c11-c12+c22,3.0)*(4.0/8.1E1)-1.0/pow(v3,2.0)*(v14/pow(v3,2.0)*v7*(1.0/6.0)+c12*v9*1.0/pow(v3,2.0)*(1.0/2.0))*pow(c11-c12+c22,4.0)*(1.0/8.1E1)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(7.0/1.98E2)-c12*(v10)*1.0/pow(v3,3.0)*pow(c11-c12+c22,4.0)*(4.0/8.1E1)+(v10)*1.0/v15*(c11-c12+c22)*(v9*1.0/pow(v3,3.0/2.0)*4.0-1.0/pow(v3,3.0/2.0)*v7*(4.0/3.0)+c12*1.0/pow(v3,5.0/2.0)*v8*(1.0/3.0)-c12*v9*1.0/pow(v3,5.0/2.0)*(v6)*3.0)*(7.0/1.98E2)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/v15*(v14/pow(v3,2.0)*v7*(1.0/6.0)+c12*v9*1.0/pow(v3,2.0)*(1.0/2.0))*(c11-c12+c22)*(7.0/1.98E2)+c12*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/pow(v3,3.0/2.0)*(c11-c12+c22)*(7.0/1.98E2))-1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,3.0)*(v9*1.0/pow(v3,3.0/2.0)*4.0-1.0/pow(v3,3.0/2.0)*v7*(4.0/3.0)+c12*1.0/pow(v3,5.0/2.0)*v8*(1.0/3.0)-c12*v9*1.0/pow(v3,5.0/2.0)*(v6)*3.0)*(1.0/2.7E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,3.0/2.0)*pow(c11-c12+c22,2.0)*(1.0/9.0)-(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/v15*(8.0/3.3E1)-c12*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/pow(v3,5.0/2.0)*pow(c11-c12+c22,3.0)*(1.0/9.0)+(v10)*1.0/v15*(c11-c12+c22)*(v9*1.0/pow(v3,3.0/2.0)*4.0-1.0/pow(v3,3.0/2.0)*v7*(4.0/3.0)+c12*1.0/pow(v3,5.0/2.0)*v8*(1.0/3.0)-c12*v9*1.0/pow(v3,5.0/2.0)*(v6)*3.0)*(8.0/3.3E1)+(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*1.0/v15*(v14/pow(v3,2.0)*v7*(1.0/6.0)+c12*v9*1.0/pow(v3,2.0)*(1.0/2.0))*(c11-c12+c22)*(8.0/3.3E1)+c12*(1.0/pow(v3,3.0/2.0)*v8*(1.0/9.0)-v9*1.0/pow(v3,3.0/2.0)*(v6))*(v10)*1.0/pow(v3,3.0/2.0)*(c11-c12+c22)*(8.0/3.3E1);
    }